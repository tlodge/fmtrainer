(this.webpackJsonpfmtrainer=this.webpackJsonpfmtrainer||[]).push([[0],{13:function(t,e,n){t.exports={button:"Train_button__2wHuI",footer:"Train_footer__WmYe4"}},25:function(t,e,n){t.exports=n(57)},30:function(t,e,n){},31:function(t,e,n){t.exports=n.p+"static/media/logo.8dad8028.svg"},5:function(t,e,n){t.exports={row:"Counter_row__1C_4f",value:"Counter_value__1d0te",button:"Counter_button__1xpSV",textbox:"Counter_textbox__3ODaX",asyncButton:"Counter_asyncButton__2UAr3 Counter_button__1xpSV"}},56:function(t,e,n){},57:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(8),i=n.n(a),c=(n(30),n(31),n(4)),s=n(2),u=n(6),l=Object(u.b)({name:"counter",initialState:{value:0},reducers:{increment:function(t){t.value+=1},decrement:function(t){t.value-=1},incrementByAmount:function(t,e){t.value+=e.payload}}}),d=l.actions,g=(d.increment,d.decrement,d.incrementByAmount,l.reducer);n(5);var f=n(7),m=n.n(f),I=function(t){m()({method:"get",url:encodeURIComponent("/record/".concat(t))})},O={NOT_LISTENING:"not listening",AWAITING_GESTURE:"awaiting gesture",AWAITING_CONFIRMATION:"awaiting confirmation",FIVE:"5",FOUR:"4",THREE:"3",TWO:"2",ONE:"1",RECORDING:"recording",TRAINING:"training"},N=["FIVE","FOUR","THREE","TWO","ONE","RECORDING"],T={NOT_LISTENING:"press button to start listening for instructions",AWAITING_GESTURE:"say <strong>record</strong> followed by the <strong><i>name of the gesture</i></strong> you'd like to train",AWAITING_CONFIRMATION:"say <strong>ready</strong> to start recording a gesture with this name or <strong>cancel</strong> to restate gesture",FIVE:"recording in <strong>five</strong> seconds...",FOUR:"recording in <strong>four</strong> seconds...",THREE:"recording in <strong>three</strong> seconds...",TWO:"recording in <strong>two</strong> seconds...",ONE:"recording in <strong>one</strong> second!",RECORDING:"record gesture, say <strong>ok</strong> or <strong>done</strong> when done, or <strong>cancel</strong> to discard",TRAINING:"now training...this will take a while..."},E=Object(u.b)({name:"train",initialState:{amListening:!1,status:O.NOT_LISTENING,instructions:T.NOT_LISTENING,gesture:"",rawTranscript:""},reducers:{setStatus:function(t,e){t.status=O[e.payload],t.instructions=T[e.payload]},setRawTranscript:function(t,e){t.rawTranscript=e.payload},reset:function(t,e){t.status=O.AWAITING_GESTURE,t.instructions=T.AWAITING_GESTURE,t.gesture=""},startedListening:function(t,e){e.payload?(t.amFinished=!1,t.amListening=!0,t.status=O.AWAITING_GESTURE,t.instructions=T.AWAITING_GESTURE):(t.status=O.NOT_LISTENING,t.instructions=T.NOT_LISTENING)},issueConfirm:function(t,e){t.readytorecord="yes"===e.payload.toLowerCase()},setGesture:function(t,e){if(""!==e.payload.trim()){var n=e.payload.toLowerCase().indexOf("record");-1!==n&&(t.gesture="".concat(e.payload.substring(n+6).trim()),t.status=O.AWAITING_CONFIRMATION,t.instructions=T.AWAITING_CONFIRMATION)}}}}),p=E.actions,b=p.setGesture,w=p.setStatus,h=p.startedListening,v=(p.amListening,p.reset),_=p.setRawTranscript,R=function(t){return t.train.gesture},A=function(t){return t.train.status},y=function(t){return t.train.instructions},S=function(t){return t.train.amListening},G=function(t){return t.train.rawTranscript},j=function(t){return function(e,n){var r=n().train;return e(_(t.toLowerCase().trim())),"train"===t.toLowerCase().trim()?(e(v()),e(w("TRAINING")),void m()({method:"get",url:"/train"})):-1!==["done","ok"].indexOf(t.toLowerCase().trim())?(e(v()),void m()({method:"get",url:"/done"})):"cancel"!==t.toLowerCase().trim()?r.status===O.AWAITING_CONFIRMATION&&"ready"===t.toLowerCase().trim()?(e(w("RECORDING_COUNTDOWN")),void e(C(r))):void e(b(t)):void e(v())}},C=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(r){r(w(N[n])),5==n&&(console.log("calling record with ",e),I(e.gesture)),n<5&&setTimeout((function(){return t(e,++n)(r)}),1e3)}},L=E.reducer,x=n(12),W=n.n(x),U=n(24),F=function(){var t=Object(U.a)(W.a.mark((function t(){return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),k=function(t){var e=Object(r.useState)(!1),n=Object(c.a)(e,2),o=n[0],a=n[1],i=Object(r.useState)(null),s=Object(c.a)(i,2),u=s[0],l=s[1],d=Object(r.useState)(""),g=Object(c.a)(d,2),f=g[0],m=g[1],I=Object(r.useState)(!0),O=Object(c.a)(I,2),N=O[0],T=O[1];return Object(r.useEffect)((function(){!u&&t.current&&(t.current instanceof HTMLVideoElement&&l(t.current))}),[t,u]),function(t){var e=Object(r.useRef)(t);Object(r.useEffect)((function(){e.current=t}),[t]),Object(r.useEffect)((function(){return function(){}}),[])}(u),Object(r.useEffect)((function(){u&&!o&&N&&F().then((function(t){u.srcObject=t,a(!0)})).catch((function(t){m(t.message),T(!1)}))}),[u,o,N]),Object(r.useEffect)((function(){var e=t.current;N?e.play():e.pause()}),[N,t]),[u,o,N,T,f]},M=n(13),D=n.n(M);function B(){var t="undefined"!==typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),e=t?new t:null;e.continous=!0,e.interimResults=!0,e.lang="en-US";var n=Object(r.useState)(),a=Object(c.a)(n,2),i=(a[0],a[1],Object(s.c)(R)),u=Object(s.c)(y),l=Object(s.c)(S),d=Object(s.c)(G),g="recording"===Object(s.c)(A),f=Object(s.b)(),I="",O="";e.onend=function(){I="",e.start()},e.onresult=function(t){O="";for(var e=t.resultIndex;e<t.results.length;e++){var n=t.results[e][0].transcript;t.results[e].isFinal?I+=n+" ":f(j(O+=n))}f(j(I))};var N=Object(r.createRef)(),T=Object(r.createRef)(),E=k(N),p=Object(c.a)(E,5),b=(p[0],p[1],p[2],p[3],p[4],function(t,e){setInterval((function(){var n;t.getContext("2d").drawImage(e,0,0,128,128),f((n=t.toDataURL("image/png"),function(t,e){m()({method:"post",url:"/image",data:{image:n}})}))}),500)});return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{padding:"0px 100px 100px 100px"}},o.a.createElement(o.a.Fragment,null,o.a.createElement("video",{style:{display:g?"block":"none"},ref:N,autoPlay:!0,muted:!0,controls:!0,width:600,height:400}),o.a.createElement("canvas",{style:{display:"none"},ref:T,width:128,height:128})),o.a.createElement("div",{style:{fontSize:80,fontWeight:700,textTransform:"uppercase",marginBottom:30}},i),l&&o.a.createElement("div",{style:{color:"#736A6A"},dangerouslySetInnerHTML:{__html:u}}),!l&&o.a.createElement("button",{id:"microphone-btn",className:D.a.button,onClick:function(){I="",console.log("in handle listener: am listening",l),l||(f(h(!0)),console.log("OK STARTING LISTENING!"),e.start())}},"START LISTENING"),o.a.createElement("button",{onClick:function(){b(T.current,N.current)}},"TAKE PICTURE")),""!=d.trim()&&o.a.createElement("div",{className:D.a.footer},'"'.concat(d,'"')))}n(56);var H=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement(B,null)))},V=Object(u.a)({reducer:{counter:g,train:L}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s.a,{store:V},o.a.createElement(H,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[25,1,2]]]);
//# sourceMappingURL=main.4616f6a7.chunk.js.map